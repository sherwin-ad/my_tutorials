# Vulnerability Assesment / Penetration Testing (VAPT)



## What is penetration testing

- A penetration test, also known as a pen test, is a simulated cyber attack against a computer system to check for exploitable vulnerabilities. 



## Why perform Penetration Testing?

• To determine the weaknesses of the existing app or system
• To analyze the current level of security
• To discover new security vulnerabilities of a newly deployed system or changes
• To ensure compliances such as ISO stantard and other government regulations
• To assess potential businesses and operational impacts in case of a breach
• To test cybersecurity teams for their effectiveness in case of the attack happens
• To protect clients’, partners’, and company’s information from Black Hat Hackers
• To avoid financial and reputational damage once compromised



## Type of Penetration Testing

1. **Black box**
   - ethical hacker has no knowledge of the system being attacked
   - no information is provided to the tester 
   - they have strictly limited knowledge of the network 
   - no information on the customer’s security policies, network  structure, operating systems, software and network protection used.
2. **White box**
   - sharing full network and system information with the tester
   - including network maps and credentials
3. **Gray box**
   - only limited information is shared with the tester

## What is Vulnerability Assessment?
- Vulnerability Assessment is a process of identifying, enumerating, scanning, researching, and analyzing possible risks.



## Information Security Teaming

**Red Team**

- employees or contractor hired to be Attackers, ethical hackers that work for an organization finding
  security holes that a malicious individual could exploit.

**Blue Team** 

- the organization’s Defenders, who are responsible for protective measures within an organization. 

![Introducing the InfoSec colour wheel — blending developers with red and  blue security teams. | Hacker Noon](https://hackernoon.com/images/f2apxyNoEZUNnwGm1NG6OQfqlJA2-254p36as.jpg)





# Phases of Penetration Testing



## I. Pre-Engagement Interactions

- Non-disclosure Agreement
- MOA  (Memorandum of Agreement)
- VAPT Scoping Questionaire

### Scoping Questionnaires

**General Information**

- Is the manager aware that a test is about to be performed?
- Are Disaster Recovery Procedures in place for the application data?
- Are there any systems which could be characterized as fragile? (systems with tendencies to crash, older operating systems, or which are unpatched)
- Are there systems on the network which the client does not own, that may require additional approval to test? (e.g. AWS)
- What is the mean time to repair systems outages?
- Is there any system monitoring in place? (NMS, SIEM, etc.)

- What are the most critical servers and applications?
- Are backups tested regularly?
- When was the last time the backups were restored and generated?
- When would you like to start and end the VAPT?
- What are the target domains and IP addresses?
- Where do you want to communicate during VAPT? (e.g. Telegram, Whastapp, Signal, Discord, etc.)
- Who is the Point of Contact? (Project Leader, Network Administrator, Server Administrator)
- How many total IP addresses are being tested?
  - How many internal IP addresses, if applicable?
  - How many external IP addresses, if applicable?
- Network Diagram and Documentations

**Website Application Information**

- How many web applications are being assessed?
  - How many static pages are being assessed? (approximate)
  - How many dynamic pages are being assessed? (approximate)

**Social Engineering Information**

- Does the client have a list of email addresses they would like a Social Engineering attack to be performed?

- Does the client have a list of phone numbers they would like a Social Engineering attack to be performed?

- Is Social Engineering for the purpose of gaining unauthorized physical access approved? If so:

- How many people will be targeted?

  

## II. Reconnaissance or Information Gathering

- is an  important first step in penetration testing. A pentester works on  gathering as much intelligence on your organization and the potential  targets for exploit.

### Types of Reconnaissance/Information Gathering

**1. Active Reconnaissance**

- is a type of information gathering in which an intruder engages with the targeted system to gather information about vulnerabilities. 
- This may be through automated scanning or manual testing using various tools like ping, traceroute, netcat etc. 
- It is faster and more accurate, however it also makes much more noise. 
- There’s an increased chance that the recon will get caught by a firewall or one of the network security devices. (Intrusion Detection Systems, network firewalls, etc.)

**Tools:**

Nmap, Metasploit etc.

### Domain Information Gathering

**Host**

```
MX Record
# host -t mx tesla.com

Name Server Record
# host -t ns tesla.com
```

**Whois** 

```
• whois facebook.com
```



**Dnsenum**

```
# dnsenum tesla.com
```



### Subdomain Enumeration

**Subfinder**

```
# subfinder -d tcm-sec.com
```





**2. Passive Reconnaissance**

- is an attempt to gain information about targeted computers and networks without actively engaging with the systems. 
- It is a gathering the information without alerting victim. 

**Tools :** 

[OSINT Framework](http://osintframework.com/) 

- focused on gathering information from free tools or resources

### Discovering Email Addresses

**1. Hunter.io**

https://hunter.io/

**2. Phonebook.cz**

https://phonebook.cz/

#### 3. theHarvester

```
# theHarvester -d tesla.com -b google
```

### Finding Sub Domain

**Pentest-Tools-Subdomain-Finder** (web-based)
https://pentest-tools.com/information-gathering/find-subdomains-of-domain#



**Subfinder**
https://github.com/projectdiscovery/subfinder

```
# subfinder -d megacorpone.com
```



### Port Scanning

#### NMAP

- The most famous port scanner

##### Stealth | SNY Scanning (-sS)

- SYN scanning is a TCP port scanning method that involves sending SYN packets to various ports on a target machine without completing a TCP handshake.

```
# nmap -sS 192.168.101.113  
```

##### TCP Connect Scanning (-sT)

- TCP connect scan is the default TCP scan type
- establish a full **connection** (Three way handshake)

```
# nmap -sT 192.168.101.113                                                               
```



##### Network Sweeping (-sn)

```
kali@kali:~$ nmap -sn 192.168.101.0/24                                                   
```

##### OS Fingerprinting (-0)

- OS detection

```
kali@kali:~$ sudo nmap -O 192.168.101.113                                                 
```

##### Banner Grabbing/Service Enumeration

We can also identify services running on specific ports by inspecting service banners (-sV) and running various OS and service enumeration scripts (-A) against the target

```
kali@kali:~$ nmap -sV -sT -A 192.168.101.113
```

##### Masscan

- This is the fastest Internet port scanner

**To scan a network segment for port 80:**

```
# masscan -p80 10.0.0.0/8
```

**To scan the entire Internet:**

```
# masscan 0.0.0.0/0 -p0-65535 --max-rate 100000
```



**Common intelligence gathering techniques include:**

- Search engine queries (Google, Bing, Yahoo , DuckDuckGo, etc.)
- Domain name searches/WHOIS lookups
- Social Engineering
- Internet Footprinting – email addresses, usernames, social networks,
- Internal Footprinting –Ping sweeps, port scanning, reverse DNS, packet sniffing



## III. Vulnerability Identification

- the tester identifies targets and maps the attack vectors. Any  information gathered during the Reconnaissance phase is used to inform  the method of attack during the penetration test.

**Threats – identify and categorize internal and external threats**

- Internal threats – Management, employees, vendors, etc.
- External threats – Ports, Network Protocols, Web Applications, Network Traffic, etc.

**Tools:** 

OpenVAS, Nessus, Nmap, Metasploit, Joomscan, Nikto etc.

### Web Scanner

**Joomscan**

Joomscan is an open source project, developed with the aim of automating the task of vulnerability detection and reliability assurance in Joomla CMS deployments.

Link: https://github.com/OWASP/joomscan

Sample Command:

```
# perl joomscan.pl -u https://www.bjmp.gov.ph
```

**Nikto**

Nikto is a highly configurable Open Source web server scanner that tests for thousands of dangerous files and programs, vulnerable server versions and various server configuration issues.

```
kali@kali:~$ nikto -host=http://www.megacorpone.com -maxtime=30s
```





## IV. Exploitation

- With a map of all  possible vulnerabilities and entry points, the pentester begins to test  the exploits found within your network, applications, and data. The goal is for the ethical hacker is to see exactly how far they can get into  your environment, identify high-value targets, and avoid any detection.

Some of the standard exploit tactics include:

- Web Application Attacks
- Network Attacks
- Wi-Fi attacks 
  - (Aircrack-ng) 
  - Wifi adapter that can go into monitor mode inject packets (TP-Link N150 TL-WN722N, Alfa AWUS036NHA)
- Physical Attacks
- Social engineering

**Tools:** 

Metasploit, Burpsuite, Netcat etc.

## V. Post-Exploitation, Risk Analysis & Recommendations

- After the exploitation phase is complete, the goal is to document the methods used to gain access to your organization’s valuable  information. The penetration tester should be able to determine the  value of the compromised systems and any value associated with the  sensitive data captured.

-  Pentesters  will provide recommendations on how to remediate the  vulnerabilities within the environment.
- Provide penetration testing report that clearly shows recommendations  for fixing security holes and vulnerabilities.

- Once the penetration testing recommendations are complete, the tester should clean up the environment, reconfigure any access he/she obtained to penetrate the environment, and prevent future unauthorized access  into the system through whatever means necessary.

Typical cleanup activities include:

- Removing any executables, scripts, and temporary files from compromised systems

- Reconfiguring settings back to the original parameters prior to the pentest

- Eliminating any rootkits installed in the environment

- Removing any user accounts created to connect to the compromised system

  

## VI. Reporting

- Reporting is often regarded as the most critical aspect of a pentest. It’s where you will obtain written recommendations from the penetration testing company and have an opportunity to review the findings from the report with the ethical hacker(s).
- The findings and detailed explanations from the report will offer you insights and opportunities to significantly improve your security  posture. The report should show you exactly how entry points were  discovered from the OSINT and Threat Modeling phase as well as how you  can remediate the security issues found during the Exploitation phase.